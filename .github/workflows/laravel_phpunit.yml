name: Laravel Automated Test

on:
  push:
    branches:
      - 'desafio'
      - 'develop'
      - 'feature/**'

jobs:
  laravel-tests-with-db:
    name: Laravel run tests
    runs-on: ubuntu-latest
    steps:
      - name: Checkout Repo
        uses: actions/checkout@v2

      - name: Laravel Setup - Install Dependencies
        run: composer install -q --no-ansi --no-interaction --no-scripts --no-progress --prefer-dist

      - name: Directory Permissions
        run: chmod -R 777 storage bootstrap/cache

      - name: Execute tests (Unit and Feature tests) via PHPUnit
        run: vendor/bin/phpunit
        env:
          APP_URL: http://localhost
